---
title: "Particle Tracking Methodology"
author: "Oak Ridges Moraine Groundwater Program"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(ggplot2)
library(sf)
library(rgdal)
library(rnaturalearth)
```

```{r basemap, include=FALSE}
lakes_sf <- ne_download(scale = 'large',
                        type = 'lakes',
                        category = 'physical') %>%
  sf::st_as_sf(lakes110, crs = 4269) %>%
  filter(name %in% c("Lake Ontario",
                     "Lake Erie",
                     "Lake Huron",
                     "Lake Simcoe",
                     "Lake Nipissing"))

lakes_sf$area <- as.numeric(st_area(lakes_sf))/1000000

# basemap (Great Lakes)
basemapGL <- ggplot() +
  theme_bw() +
  theme(axis.text = element_blank()) +  
  geom_sf(data = lakes_sf,
          mapping = aes(geometry = geometry),
          color = "black",
          fill = "lightblue")
```

```{r geospatial, include=FALSE}
model.bounds <- st_as_sf(readOGR("shp/230306-models.geojson",verbose = FALSE))
```


## Introduction

The ORMGP particle tracking web-tool shows both the forward or backward particle tracking from a site that is being studied.  The tool is built upon [numerical models](/snapshots/md/numerical-model-custodianship-program.html) which have organized, synthesized and interpreted a wealth of hydrogeological information (e.g., boreholes, geological mapping, previous studies, etc.). 


Particle tracking can prove important and useful from a number of perspectives:

- For any groundwater study where degraded groundwater quality has been detected, particle tracking can provide an initial indication of where the degraded water quality might have originated.  An evaluation of backward tracking from the site can help to quickly point out up-gradient land uses that might be contributing to degraded water quality, while forward tracking can indicate potential areas at risk. More detailed follow up investigations can then be directed to the right area.

- For proposed development in rural areas, where water supplies are from wells, and where waste water is directed to septic systems, particle tracking is useful for showing the general direction of groundwater flow. The overall development can be designed to avoid having septic systems positioned such that they might affect nearby well water supplies. Even at a site scale, Knowing the generalized groundwater flow directions allows for appropriate siting of wells (up-gradient from septic systems) and septic beds (down-gradient of wells).  The particle tracking tool can also reveal potential up-gradient land uses that might have an influence on well water quality in a proposed development.

- Ecological studies, where aquatic organisms are of interest, could also make use of particle tracking.  By examining the backward particle tracking from streams, existing or proposed land uses that might affect stream water quality can be assessed, and potential mitigation proposed. Ecologically Groundwater Recharge Areas (EGRA, *formerly ESGRA*) make use of such particle tracks to link recharge to discharge areas.  If new important ecological stream reaches are identified, then preliminary delineation of EGRAs can be made using the tool.  This can lead to early mitigation activities.



# Numerical Model Selection

```{r mapModels, echo=FALSE}
basemapGL +
  geom_sf(data=model.bounds, fill='blue', alpha=.3) +
  geom_sf_label(data=model.bounds, aes(label = Name)) +
  coord_sf(default_crs = st_crs(4326),
           ylim = c(43.2, 44.9),
           xlim = c(-80.25, -77.5),
           expand = TRUE)
```




### 7 models used:

1. Regional model (MODFLOW)
1. South Halton (MODFLOW)
1. CVC (FEFLOW)
1. NVCA-SSEA (FEFLOW)
1. Ramara Whites Talbot (MODFLOW)
1. York Tier-3 (MODFLOW)
1. Durham (MODFLOW)


The steady state flux field of the above models were computed by running each model

at every active model cell/element, a particle was placed at the cells centroid (or top of water surface whichever less) and tracked forward and backward using the Pollock method for the MODFLOW models, and a vector triangulation scheme for the FEFLOW models


